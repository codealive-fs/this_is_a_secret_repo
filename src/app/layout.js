"use client"
import { useEffect, useState } from "react";
import { Inter } from "next/font/google";
import "./globals.css";
import Link from 'next/link';
import Header from "./_compoents/Header"
import { Toaster } from "@/components/ui/sonner"
import { AuthProvider } from "./_context/AuthContext";
import { JobsProvider } from "./_context/JobsContext";
const inter = Inter({ subsets: ["latin"] });

const metadata = {
  title: "Create Next App",
  description: "Generated by create next app",
};

export default function RootLayout({ children }) {
  
  const [token, setThisToken] = useState(null);
  const [user, setThisUser] = useState(null);
  
  
  const setToken = (accesstoken = null) => {
    if (accesstoken) {
      console.log('faiz');
      
      setThisToken(accesstoken);
    }
    else setThisToken(false);
  }
  const setUser = () => {
    const isUser = JSON.parse(localStorage.getItem("user"));
    if (isUser) setThisUser(isUser)
      else setThisUser(null)
  }
  
  useEffect(() => {
    const jwt = localStorage.getItem('jwt');
    if (jwt) {
      setToken(jwt)
      setUser();
    }
    else {
      console.log("No token found");
      setToken(null);
      setUser();
    }
  }, [token])
  // console.log("Token from sessionStorage:", token); // Log the token here
  // debugger

  return (
    <html lang="en">
      <body className={inter.className}>
          <AuthProvider value={{ token, user, setToken, setUser }}>
            <JobsProvider>
                <div className="md:px-16">
                    <Header />
                    {children}
                    <Toaster />
                    <footer className="container p-6 text-gray-500">
                      Job Board &copy; 2024 - All rights reserved
                    </footer>
                </div>
            </JobsProvider>
          </AuthProvider>
      </body>
    </html>
  );
}



//////////////////////////////////////////////////////////////////////////////////////////////
// "use client"
// import { useEffect, useState } from "react";
// import { Inter } from "next/font/google";
// import "./globals.css";
// import Link from 'next/link';
// import Header from "./_compoents/Header"
// import { Toaster } from "@/components/ui/sonner"
// import { AuthProvider } from "./_context/AuthContext";
// import { JobsProvider } from "./_context/JobsContext";
// import { NEXT_CACHE_REVALIDATE_TAG_TOKEN_HEADER } from "next/dist/lib/constants";
// const inter = Inter({ subsets: ["latin"] });

// const metadata = {
//   title: "Create Next App",
//   description: "Generated by create next app",
// };

// export default function RootLayout({ children }) {

//   const [token, setThisToken] = useState(null);
//   const [user, setThisUser] = useState(null);


//   const setToken = (accesstoken = null) => {
//     if (accesstoken) {
//       setThisToken(accesstoken);
//     }
//     else setThisToken(false);
//   }
//   const setUser = () => {
//     const isUser = JSON.parse(sessionStorage.getItem("user"));
//     if (isUser) setThisUser(isUser)
//     else setThisUser(null)
//   }

//   useEffect(() => {
//     const jwt = sessionStorage.getItem('jwt');
//     if (jwt) {
//       setToken(jwt)
//       setUser();
//     }
//     else {
//       setToken(null);
//       setUser();
//     }
//   }, [token])

//   return (
//     <html lang="en">
//       <body className={inter.className}>
//         <AuthProvider value={{ token, setToken, user, setUser }}>
//           <JobsProvider>
//             <div className="container">
//               <Header />
//             </div>
//             {children}
//             <Toaster />
//             <footer className="container p-6 text-gray-500">
//               Job Board &copy; 2024 - All rights reserved
//             </footer>
//           </JobsProvider>
//         </AuthProvider>
//       </body>
//     </html>
//   );
// }
//////////////////////////////////////////////////////////////////////////////////////////